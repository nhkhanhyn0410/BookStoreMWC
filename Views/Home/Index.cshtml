@model BookStoreMVC.Models.ViewModels.HomeViewModel
@{
    ViewData["Title"] = "Home";
    
}
<div>
<!-- Hero Section -->
<section class="bg-gradient-to-r from-primary-600 to-purple-700 text-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <div class="space-y-6">
                <h1 class="text-4xl md:text-6xl font-bold leading-tight">
                    Khám phá tiếp theo của bạn là 
                    <span class="text-yellow-300">Những bài đọc tuyệt vời</span>
                </h1>
                <p class="text-xl text-gray-200 leading-relaxed">
                    Khám phá hàng ngàn cuốn sách thuộc mọi thể loại. 
                    Từ những cuốn sách bán chạy nhất đến những viên ngọc ẩn, 
                    Tìm cuốn sách hoàn hảo của bạn và bắt đầu những cuộc hành trình khó quên.
                </p>
                <div class="flex flex-col sm:flex-row gap-4">
                    <a asp-controller="Books" asp-action="Index" class="btn btn-lg bg-yellow-400 text-gray-900 hover:bg-yellow-300">
                        <i class="fas fa-book-open mr-2"></i>
                        Browse Books
                    </a>
                    <a asp-controller="Books" asp-action="Index" asp-route-categoryId="1" class="btn btn-lg btn-outline border-white text-white hover:bg-white hover:text-gray-900">
                        <i class="fas fa-fire mr-2"></i>
                        Bestsellers
                    </a>
                </div>
                
                <!-- Stats -->
                <div class="flex flex-wrap gap-8 pt-8">
                    <div class="text-center">
                        <div class="text-3xl font-bold">@Model.TotalBooks.ToString("N0")</div>
                        <div class="text-gray-300">Books Available</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold">@Model.TotalCategories</div>
                        <div class="text-gray-300">Categories</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl font-bold">@Model.TotalUsers.ToString("N0")</div>
                        <div class="text-gray-300">Happy Readers</div>
                    </div>
                </div>
            </div>
            
            <div class="relative">
                <div class="relative z-10">
                    <img src="/images/hero-books.jpg" alt="Stack of books" class="rounded-lg shadow-2xl" />
                </div>
                <!-- Decorative elements -->
                <div class="absolute top-4 left-4 w-full h-full bg-yellow-400 rounded-lg -z-10"></div>
                <div class="absolute -top-4 -right-4 w-24 h-24 bg-purple-400 rounded-full opacity-50"></div>
                <div class="absolute bottom-8 -left-8 w-32 h-32 bg-pink-400 rounded-full opacity-30"></div>
            </div>
        </div>
    </div>
</section>

<!-- Featured Books Section -->
@if (Model.FeaturedBooks.Any())
{
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
                    <i class="fas fa-star text-yellow-500 mr-2"></i>
                    Featured Books
                </h2>
                <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                    Discover our handpicked selection of exceptional books, featuring special discounts and exclusive offers.
                </p>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                @foreach (var book in Model.FeaturedBooks)
                {
                    <div class="book-card group">
                        <div class="relative overflow-hidden">
                            @if (book.HasDiscount)
                            {
                                <div class="absolute top-2 left-2 bg-red-500 text-white px-2 py-1 rounded-lg text-sm font-semibold z-10">
                                    @book.DiscountPercentage% OFF
                                </div>
                            }
                            <img src="@(book.ImageUrl ?? "/images/books/placeholder.jpg")" 
                                 alt="@book.Title" 
                                 class="book-image group-hover:scale-105 transition-transform duration-300" />
                            
                            <!-- Quick Actions Overlay -->
                            <div class="absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center space-x-2">
                                <button onclick="quickView(@book.Id)" class="btn btn-sm bg-white text-gray-900 hover:bg-gray-100">
                                    <i class="fas fa-eye"></i>
                                </button>
                                @if (User.Identity?.IsAuthenticated == true)
                                {
                                    <button onclick="addToCart(@book.Id)" class="btn btn-sm btn-primary">
                                        <i class="fas fa-cart-plus"></i>
                                    </button>
                                    <button onclick="addToWishlist(@book.Id)" class="btn btn-sm bg-red-500 text-white hover:bg-red-600">
                                        <i class="fas fa-heart"></i>
                                    </button>
                                }
                            </div>
                        </div>
                        
                        <div class="card-body">
                            <h3 class="book-title">
                                <a asp-controller="Books" asp-action="Details" asp-route-id="@book.Id" 
                                   class="hover:text-primary-600 transition-colors">
                                    @book.Title
                                </a>
                            </h3>
                            <p class="book-author">by @book.Author</p>
                            
                            <!-- Rating -->
                            @if (book.ReviewCount > 0)
                            {
                                <div class="flex items-center space-x-2 mb-2">
                                    <div class="flex text-yellow-400">
                                        @for (int i = 1; i <= 5; i++)
                                        {
                                            <i class="fas fa-star @(i <= book.AverageRating ? "" : "text-gray-300")"></i>
                                        }
                                    </div>
                                    <span class="text-sm text-gray-600">(@book.ReviewCount)</span>
                                </div>
                            }
                            
                            <!-- Price -->
                            <div class="flex items-center justify-between">
                                <div class="price-section">
                                    @if (book.HasDiscount)
                                    {
                                        <span class="text-lg font-bold text-primary-600">$@book.DiscountPrice</span>
                                        <span class="text-sm text-gray-500 line-through ml-2">$@book.Price</span>
                                    }
                                    else
                                    {
                                        <span class="text-lg font-bold text-primary-600">$@book.Price</span>
                                    }
                                </div>
                                
                                @if (User.Identity?.IsAuthenticated == true)
                                {
                                    <button onclick="addToCart(@book.Id)" class="btn btn-sm btn-primary">
                                        <i class="fas fa-cart-plus mr-1"></i>
                                        Add to Cart
                                    </button>
                                }
                            </div>
                        </div>
                    </div>
                }
            </div>
            
            <div class="text-center mt-8">
                <a asp-controller="Books" asp-action="Index" class="btn btn-outline btn-lg">
                    View All Books
                    <i class="fas fa-arrow-right ml-2"></i>
                </a>
            </div>
        </div>
    </section>
}

<!-- Categories Section -->
@if (Model.PopularCategories.Any())
{
    <section class="py-16 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
                    <i class="fas fa-th-large text-primary-600 mr-2"></i>
                    Browse by Category
                </h2>
                <p class="text-xl text-gray-600">
                    Find books in your favorite genres and discover new interests.
                </p>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                @foreach (var category in Model.PopularCategories)
                {
                    <a asp-controller="Books" asp-action="Category" asp-route-id="@category.Id" 
                       class="group bg-white rounded-xl p-6 text-center hover:shadow-lg hover:-translate-y-1 transition-all duration-300 border border-gray-200">
                        <div class="w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:bg-primary-200 transition-colors">
                            <i class="fas fa-book text-primary-600 text-2xl"></i>
                        </div>
                        <h3 class="font-semibold text-gray-900 group-hover:text-primary-600 transition-colors">
                            @category.NameCategory
                        </h3>
                        <p class="text-sm text-gray-500 mt-1">@category.BookCount books</p>
                    </a>
                }
            </div>
        </div>
    </section>
}

<!-- New Books Section -->
@if (Model.NewBooks.Any())
{
    <section class="py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
                    <i class="fas fa-clock text-green-600 mr-2"></i>
                    New Arrivals
                </h2>
                <p class="text-xl text-gray-600">
                    Fresh additions to our collection. Be the first to discover these new books.
                </p>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                @foreach (var book in Model.NewBooks)
                {
                    <div class="book-card group">
                        <div class="relative overflow-hidden">
                            <div class="absolute top-2 left-2 bg-green-500 text-white px-2 py-1 rounded-lg text-sm font-semibold z-10">
                                NEW
                            </div>
                            <img src="@(book.ImageUrl ?? "/images/books/placeholder.jpg")" 
                                 alt="@book.Title" 
                                 class="book-image group-hover:scale-105 transition-transform duration-300" />
                        </div>
                        
                        <div class="card-body">
                            <h3 class="book-title">
                                <a asp-controller="Books" asp-action="Details" asp-route-id="@book.Id" 
                                   class="hover:text-primary-600 transition-colors">
                                    @book.Title
                                </a>
                            </h3>
                            <p class="book-author">by @book.Author</p>
                            <div class="flex items-center justify-between mt-4">
                                <span class="book-price">$@book.FinalPrice</span>
                                @if (User.Identity?.IsAuthenticated == true)
                                {
                                    <button onclick="addToCart(@book.Id)" class="btn btn-sm btn-primary">
                                        Add to Cart
                                    </button>
                                }
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </section>
}

<!-- Newsletter Section -->
<section class="py-16 bg-primary-600">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div class="space-y-6">
            <h2 class="text-3xl md:text-4xl font-bold text-white">
                Stay Updated with Latest Books
            </h2>
            <p class="text-xl text-primary-100">
                Subscribe to our newsletter and be the first to know about new arrivals, special offers, and book recommendations.
            </p>
            
            <form class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto">
                <input type="email" 
                       placeholder="Enter your email address" 
                       class="flex-1 px-4 py-3 rounded-lg border-0 focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-primary-600">
                <button type="submit" class="btn bg-white text-primary-600 hover:bg-gray-100 px-8">
                    Subscribe
                </button>
            </form>
            
            <p class="text-sm text-primary-200">
                We respect your privacy. Unsubscribe at any time.
            </p>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        // Initialize cart count on page load
        document.addEventListener('DOMContentLoaded', function() {
            @if (User.Identity?.IsAuthenticated == true)
            {
                <text>updateCartCount();</text>
            }
        });

        function quickView(bookId) {
            // Quick view functionality
            console.log('Quick view for book:', bookId);
            // You can implement a modal or redirect to book details
        }

        function addToCart(bookId) {
            @if (User.Identity?.IsAuthenticated == true)
            {
                <text>
                fetch('/Cart/AddToCart', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]')?.value || ''
                    },
                    body: JSON.stringify({ bookId: bookId, quantity: 1 })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        showNotification('Book added to cart successfully!', 'success');
                        updateCartCount();
                    } else {
                        showNotification(data.message || 'Failed to add book to cart', 'error');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showNotification('An error occurred while adding the book to cart', 'error');
                });
                </text>
            }
            else
            {
                <text>
                window.location.href = '/Account/Login?returnUrl=' + encodeURIComponent(window.location.pathname);
                </text>
            }
        }

        function addToWishlist(bookId) {
            @if (User.Identity?.IsAuthenticated == true)
            {
                <text>
                // Wishlist functionality
                console.log('Add to wishlist:', bookId);
                showNotification('Added to wishlist!', 'success');
                </text>
            }
            else
            {
                <text>
                window.location.href = '/Account/Login?returnUrl=' + encodeURIComponent(window.location.pathname);
                </text>
            }
        }
    </script>
}

<style>
    .book-card:hover .card-body {
        transform: translateY(-2px);
    }
    
    .price-section {
        display: flex;
        align-items: center;
        flex-wrap: wrap;
    }
</style>
</div>